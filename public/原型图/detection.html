<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>异常检测 - 恶意登录异常检测系统</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>🛡️ 恶意登录异常检测系统</h1>
            <nav>
                <ul>
                    <li><a href="index.html">首页</a></li>
                    <li><a href="detection.html" class="active">异常检测</a></li>
                    <li><a href="notification.html">邮件通知</a></li>
                    <li><a href="analysis.html">数据分析</a></li>
                    <li><a href="history.html">历史记录</a></li>
                    <li><a href="admin.html">管理端</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="detection-control">
            <h2>实时异常检测</h2>
            <div class="control-panel">
                <div class="detection-status">
                    <span class="status-indicator running"></span>
                    <span>检测状态：运行中</span>
                </div>
                <div class="control-buttons">
                    <button class="btn btn-success" id="startBtn">开始检测</button>
                    <button class="btn btn-warning" id="pauseBtn">暂停检测</button>
                    <button class="btn btn-danger" id="stopBtn">停止检测</button>
                </div>
            </div>
        </section>

        <section class="detection-config">
            <h3>检测配置</h3>
            <div class="config-form">
                <div class="form-group">
                    <label>检测间隔 (秒):</label>
                    <input type="number" value="30" min="10" max="300">
                </div>
                <div class="form-group">
                    <label>敏感度:</label>
                    <select>
                        <option value="low">低</option>
                        <option value="medium" selected>中</option>
                        <option value="high">高</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>日志源路径:</label>
                    <input type="text" value="/var/log/auth.log" placeholder="输入日志文件路径">
                </div>
            </div>
        </section>

        <section class="real-time-results">
            <h3>实时检测结果</h3>
            <div class="results-table">
                <table>
                    <thead>
                        <tr>
                            <th>时间</th>
                            <th>IP地址</th>
                            <th>用户名</th>
                            <th>异常类型</th>
                            <th>风险等级</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="detectionResults">
                        <tr>
                            <td>14:35:22</td>
                            <td>192.168.1.100</td>
                            <td>admin</td>
                            <td>暴力破解</td>
                            <td><span class="risk-high">高危</span></td>
                            <td><button class="btn btn-sm btn-primary">详情</button></td>
                        </tr>
                        <tr>
                            <td>14:33:15</td>
                            <td>10.0.0.25</td>
                            <td>user01</td>
                            <td>异常时间登录</td>
                            <td><span class="risk-medium">中危</span></td>
                            <td><button class="btn btn-sm btn-primary">详情</button></td>
                        </tr>
                        <tr>
                            <td>14:30:08</td>
                            <td>172.16.0.50</td>
                            <td>guest</td>
                            <td>新IP登录</td>
                            <td><span class="risk-low">低危</span></td>
                            <td><button class="btn btn-sm btn-primary">详情</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="detection-chart">
            <h3>检测趋势图</h3>
            <div class="chart-container">
                <canvas id="detectionChart" width="800" height="300"></canvas>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 恶意登录异常检测系统. 保留所有权利.</p>
        </div>
    </footer>

    <script>
        // 模拟实时数据更新
        function updateDetectionResults() {
            // 这里可以添加实时数据更新逻辑
            console.log('更新检测结果...');
        }
        
        setInterval(updateDetectionResults, 5000);
    </script>
</body>
</html>