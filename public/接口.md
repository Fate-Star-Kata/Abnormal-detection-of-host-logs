# 全局公共参数

**全局Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**全局Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**全局Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**全局认证方式**

> 无需认证

# 状态码说明

| 状态码   | 中文描述 |
| -------- | -------- |
| 暂无参数 |

# 日志异常检测

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:06

> 更新时间: 2025-09-05 15:33:06

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

## 仪表板

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取仪表板统计数据

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:34:30

**获取系统概览统计数据，包括今日检测次数、恶意登录数、威胁IP数等**

**接口状态**

> 开发中

**接口URL**

> /malicious/dashboard/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取仪表板数据(200)

```javascript
{"code":200,"msg":"获取仪表板数据成功","data":{"today_detections":11,"today_malicious":0,"today_threat_ips":0,"system_status":"normal","uptime_days":72,"detection_trend":100.0,"malicious_trend":0,"threat_trend":0}}
```

| 参数名           | 示例值 | 参数类型 | 参数描述           |
| ---------------- | ------ | -------- | ------------------ |
| today_detections | -      | integer  | 今日检测次数       |
| today_malicious  | -      | integer  | 今日恶意登录数     |
| today_threat_ips | -      | integer  | 今日威胁IP数       |
| system_status    | -      | string   | 系统状态           |
| uptime_days      | -      | integer  | 系统运行天数       |
| detection_trend  | -      | number   | 检测趋势百分比     |
| malicious_trend  | -      | number   | 恶意登录趋势百分比 |
| threat_trend     | -      | number   | 威胁趋势百分比     |

- 失败(404)

```javascript
暂无数据;
```

**Query**

## 实时检测

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取实时检测状态

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:34:44

**获取当前检测系统状态和最近检测记录**

**接口状态**

> 开发中

**接口URL**

> /malicious/realtime-detection/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取实时检测状态(200)

```javascript
{"status":"running","current_config":null,"recent_detections":[{"id":15,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T15:13:17.734706"},{"id":14,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:48:41.972029"},{"id":13,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:47:41.494569"},{"id":10,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:37:22.897737"},{"id":9,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:28:01.736153"},{"id":8,"ip_address":"192.168.1.100","username":"testuser","login_time":"2025-09-05T14:27:31.367670","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:27:31.367670"},{"id":7,"ip_address":"10.0.0.1","username":"finaltest","login_time":"2025-09-05T14:24:54.264898","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"Test City","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:24:54.264898"},{"id":6,"ip_address":"192.168.1.600","username":"testuser6","login_time":"2025-09-05T14:24:23.493620","risk_score":0.0,"risk_level":"minimal","risk_level_display":"minimal","is_malicious":false,"location":"Shenzhen","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:24:23.493620"},{"id":5,"ip_address":"192.168.1.500","username":"testuser5","login_time":"2025-09-05T14:23:24.337696","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"Shanghai","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:23:24.337696"},{"id":4,"ip_address":"192.168.1.400","username":"testuser4","login_time":"2025-09-05T14:22:55.088083","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"Beijing","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:22:55.088586"}],"active_threats":0,"detection_rate":4.0}
```

| 参数名                               | 示例值 | 参数类型 | 参数描述         |
| ------------------------------------ | ------ | -------- | ---------------- |
| status                               | -      | string   | 检测状态         |
| current_config.id                    | -      | integer  | 配置ID           |
| current_config.name                  | -      | string   | 配置名称         |
| current_config.description           | -      | string   | 配置描述         |
| current_config.sensitivity           | -      | number   | 敏感度           |
| current_config.high_risk_threshold   | -      | number   | 高风险阈值       |
| current_config.medium_risk_threshold | -      | number   | 中风险阈值       |
| current_config.detection_interval    | -      | integer  | 检测间隔（秒）   |
| current_config.is_active             | -      | boolean  | 是否激活         |
| current_config.created_at            | -      | string   | 创建时间         |
| current_config                       | -      | object   | -                |
| recent_detections.id                 | -      | integer  | 记录ID           |
| recent_detections.ip_address         | -      | string   | IP地址           |
| recent_detections.username           | -      | string   | 用户名           |
| recent_detections.login_time         | -      | string   | 登录时间         |
| recent_detections.risk_score         | -      | number   | 风险评分         |
| recent_detections.risk_level         | -      | string   | 风险等级         |
| recent_detections.risk_level_display | -      | string   | 风险等级显示名称 |
| recent_detections.is_malicious       | -      | boolean  | 是否为恶意登录   |
| recent_detections.status             | -      | string   | 处理状态         |
| recent_detections.status_display     | -      | string   | 状态显示名称     |
| recent_detections.user_agent         | -      | string   | 用户代理         |
| recent_detections.location           | -      | string   | 登录位置         |
| recent_detections.anomaly_type       | -      | string   | 异常类型         |
| recent_detections.notes              | -      | string   | 备注             |
| recent_detections.created_at         | -      | string   | 创建时间         |
| recent_detections.updated_at         | -      | string   | 更新时间         |
| active_threats                       | -      | integer  | 活跃威胁数       |
| detection_rate                       | -      | number   | 检测率           |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 执行单次检测

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:34:48

**对单个登录事件进行恶意检测**

**接口状态**

> 开发中

**接口URL**

> /malicious/realtime-detection/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"ip_address": "192.168.0.1",
	"username": "string",
	"login_time": "2019-08-24 14:15:22.123",
	"user_agent": "string",
	"location": "string"
}
```

| 参数名     | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ---------- | ------ | -------- | -------- | -------- |
| ip_address | -      | string   | 是       | IP地址   |
| username   | -      | string   | 是       | 用户名   |
| login_time | -      | string   | 是       | 登录时间 |
| user_agent | -      | string   | 否       | 用户代理 |
| location   | -      | string   | 否       | 登录位置 |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"success":true,"detection_record":{"id":16,"risk_level_display":"minimal","status_display":"待处理","ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24 14:15:22.123","risk_score":0.0,"risk_level":"minimal","is_malicious":false,"detection_features":{"method":"ml_model","confidence":7.173867122819294e-07},"user_agent":"string","location":"string","status":"pending","notes":"","created_at":"2025-09-05T15:34:45.636016","updated_at":"2025-09-05T15:34:45.636016"},"prediction":{"is_malicious":false,"risk_score":0.0,"risk_level":"minimal","confidence":7.173867122819294e-07,"method":"ml_model"}}
```

- 失败(404)

```javascript
暂无数据;
```

- 检测成功(201)

```javascript
{
	"success": "",
	"detection_record": {
		"id": 0,
		"ip_address": "",
		"username": "",
		"login_time": "",
		"risk_score": "",
		"risk_level": "",
		"risk_level_display": "",
		"is_malicious": "",
		"status": "",
		"status_display": "",
		"user_agent": "",
		"location": "",
		"anomaly_type": "",
		"notes": "",
		"created_at": "",
		"updated_at": ""
	},
	"prediction": {
		"risk_score": "",
		"risk_level": "",
		"is_malicious": "",
		"confidence": "",
		"method": "",
		"features": {}
	}
}
```

| 参数名                              | 示例值 | 参数类型 | 参数描述         |
| ----------------------------------- | ------ | -------- | ---------------- |
| success                             | -      | boolean  | 检测是否成功     |
| detection_record.id                 | -      | integer  | 记录ID           |
| detection_record.ip_address         | -      | string   | IP地址           |
| detection_record.username           | -      | string   | 用户名           |
| detection_record.login_time         | -      | string   | 登录时间         |
| detection_record.risk_score         | -      | number   | 风险评分         |
| detection_record.risk_level         | -      | string   | 风险等级         |
| detection_record.risk_level_display | -      | string   | 风险等级显示名称 |
| detection_record.is_malicious       | -      | boolean  | 是否为恶意登录   |
| detection_record.status             | -      | string   | 处理状态         |
| detection_record.status_display     | -      | string   | 状态显示名称     |
| detection_record.user_agent         | -      | string   | 用户代理         |
| detection_record.location           | -      | string   | 登录位置         |
| detection_record.anomaly_type       | -      | string   | 异常类型         |
| detection_record.notes              | -      | string   | 备注             |
| detection_record.created_at         | -      | string   | 创建时间         |
| detection_record.updated_at         | -      | string   | 更新时间         |
| detection_record                    | -      | object   | -                |
| prediction.risk_score               | -      | number   | 风险评分         |
| prediction.risk_level               | -      | string   | 风险等级         |
| prediction.is_malicious             | -      | boolean  | 是否为恶意登录   |
| prediction.confidence               | -      | number   | 预测置信度       |
| prediction.method                   | -      | string   | 预测方法         |
| prediction.features                 | -      | object   | 特征数据         |
| prediction                          | -      | object   | -                |

- 请求参数错误(400)

```javascript
{
	"success": "",
	"error": "",
	"error_code": "",
	"details": {}
}
```

| 参数名     | 示例值 | 参数类型 | 参数描述 |
| ---------- | ------ | -------- | -------- |
| success    | -      | boolean  | -        |
| error      | -      | string   | 错误描述 |
| error_code | -      | string   | 错误代码 |
| details    | -      | object   | 错误详情 |

**Query**

## 数据分析

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取检测分析数据

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:36:36

**获取指定时间范围内的检测统计和分析数据**

**接口状态**

> 开发中

**接口URL**

> /malicious/detection-analysis/?time_range=3&risk_level=low

**请求方式**

> GET

**Content-Type**

> json

**请求Query参数**

| 参数名     | 示例值 | 参数类型 | 是否必填 | 参数描述                     |
| ---------- | ------ | -------- | -------- | ---------------------------- |
| time_range | 3      | string   | 否       | 时间范围                     |
| risk_level | low    | string   | 否       | 风险等级过滤（low、minimal） |

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取分析数据(200)

```javascript
{"time_range":"3","total_detections":4,"malicious_count":0,"risk_distribution":{"low":4},"hourly_stats":[{"hour":0,"count":0},{"hour":1,"count":0},{"hour":2,"count":0},{"hour":3,"count":0},{"hour":4,"count":0},{"hour":5,"count":0},{"hour":6,"count":0},{"hour":7,"count":0},{"hour":8,"count":0},{"hour":9,"count":0},{"hour":10,"count":0},{"hour":11,"count":0},{"hour":12,"count":0},{"hour":13,"count":0},{"hour":14,"count":3},{"hour":15,"count":1},{"hour":16,"count":0},{"hour":17,"count":0},{"hour":18,"count":0},{"hour":19,"count":0},{"hour":20,"count":0},{"hour":21,"count":0},{"hour":22,"count":0},{"hour":23,"count":0}],"top_threat_ips":[],"geographic_distribution":[{"country":"China","count":0},{"country":"USA","count":0},{"country":"Russia","count":0},{"country":"Others","count":0}]}
```

| 参数名                          | 示例值 | 参数类型 | 参数描述   |
| ------------------------------- | ------ | -------- | ---------- |
| time_range                      | -      | string   | 时间范围   |
| total_detections                | -      | integer  | 总检测次数 |
| malicious_count                 | -      | integer  | 恶意登录数 |
| risk_distribution.high          | -      | integer  | -          |
| risk_distribution.medium        | -      | integer  | -          |
| risk_distribution.low           | -      | integer  | -          |
| risk_distribution               | -      | object   | 风险分布   |
| hourly_stats.hour               | -      | integer  | -          |
| hourly_stats.count              | -      | integer  | -          |
| top_threat_ips.ip_address       | -      | string   | -          |
| top_threat_ips.count            | -      | integer  | -          |
| top_threat_ips.avg_risk_score   | -      | number   | -          |
| geographic_distribution.country | -      | string   | -          |
| geographic_distribution.count   | -      | integer  | -          |

- 失败(404)

```javascript
暂无数据;
```

**Query**

## 机器学习模型

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取模型信息

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:36:39

**获取当前使用的机器学习模型信息**

**接口状态**

> 开发中

**接口URL**

> /malicious/ml-model/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取模型信息(200)

```javascript
{"status":"available","method":"ml_model","model_path":"D:\\Workspace\\基于主机日志\\models\\best_model.pkl","preprocessor_path":"D:\\Workspace\\基于主机日志\\processed_data\\preprocessor.pkl","model_type":"GradientBoostingClassifier"}
```

| 参数名         | 示例值 | 参数类型 | 参数描述     |
| -------------- | ------ | -------- | ------------ |
| model_name     | -      | string   | 模型名称     |
| version        | -      | string   | 模型版本     |
| accuracy       | -      | number   | 模型准确率   |
| f1_score       | -      | number   | F1分数       |
| is_available   | -      | boolean  | 模型是否可用 |
| last_trained   | -      | string   | 最后训练时间 |
| features_count | -      | integer  | 特征数量     |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 执行模型预测

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:38:03

**直接使用机器学习模型进行预测（不保存记录）**

**接口状态**

> 开发中

**接口URL**

> /malicious/ml-model/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"ip_address": "192.168.0.1",
	"username": "string",
	"login_time": "2019-08-24 14:15:22.123",
	"user_agent": "string",
	"location": "string"
}
```

| 参数名     | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ---------- | ------ | -------- | -------- | -------- |
| ip_address | -      | string   | 是       | IP地址   |
| username   | -      | string   | 是       | 用户名   |
| login_time | -      | string   | 是       | 登录时间 |
| user_agent | -      | string   | 否       | 用户代理 |
| location   | -      | string   | 否       | 登录位置 |

**认证方式**

> 继承父级

**响应示例**

- 预测成功(200)

```javascript
{"is_malicious":false,"risk_score":0.0,"risk_level":"minimal","confidence":7.173867122819294e-07,"method":"ml_model"}
```

| 参数名       | 示例值 | 参数类型 | 参数描述       |
| ------------ | ------ | -------- | -------------- |
| risk_score   | -      | number   | 风险评分       |
| risk_level   | -      | string   | 风险等级       |
| is_malicious | -      | boolean  | 是否为恶意登录 |
| confidence   | -      | number   | 预测置信度     |
| method       | -      | string   | 预测方法       |
| features     | -      | object   | 特征数据       |

- 失败(404)

```javascript
暂无数据;
```

- 模型不可用(503)

```javascript
{
	"success": "",
	"error": "",
	"error_code": "",
	"details": {}
}
```

| 参数名     | 示例值 | 参数类型 | 参数描述 |
| ---------- | ------ | -------- | -------- |
| success    | -      | boolean  | -        |
| error      | -      | string   | 错误描述 |
| error_code | -      | string   | 错误代码 |
| details    | -      | object   | 错误详情 |

**Query**

## 检测记录

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取检测记录列表

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:39:14

**获取检测记录列表，支持分页和过滤**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/?page=1&page_size=1&ip_address=&username=&risk_level=low&status=&start_time=2025-09-05&end_time=2025-09-20

**请求方式**

> GET

**Content-Type**

> json

**请求Query参数**

| 参数名     | 示例值     | 参数类型 | 是否必填 | 参数描述                 |
| ---------- | ---------- | -------- | -------- | ------------------------ |
| page       | 1          | integer  | 否       | 页码                     |
| page_size  | 1          | integer  | 否       | 每页数量                 |
| ip_address | -          | string   | 否       | IP地址过滤               |
| username   | -          | string   | 否       | 用户名过滤               |
| risk_level | low        | string   | 否       | 风险等级过滤minimal、low |
| status     | -          | string   | 否       | 状态过滤pending          |
| start_time | 2025-09-05 | string   | 否       | 开始时间                 |
| end_time   | 2025-09-20 | string   | 否       | 结束时间                 |

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取检测记录列表(200)

```javascript
{"code":200,"msg":"获取检测记录列表成功","data":[{"id":15,"ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"string","status":"pending","status_display":"待处理","created_at":"2025-09-05T15:13:17.734706"},{"id":5,"ip_address":"192.168.1.500","username":"testuser5","login_time":"2025-09-05T14:23:24.337696","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"Shanghai","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:23:24.337696"},{"id":4,"ip_address":"192.168.1.400","username":"testuser4","login_time":"2025-09-05T14:22:55.088083","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"Beijing","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:22:55.088586"},{"id":3,"ip_address":"192.168.1.300","username":"testuser3","login_time":"2025-09-05T14:21:15.368463","risk_score":0.0,"risk_level":"low","risk_level_display":"低风险","is_malicious":false,"location":"Guangzhou","status":"pending","status_display":"待处理","created_at":"2025-09-05T14:21:15.368463"}]}
```

| 参数名                     | 示例值 | 参数类型 | 参数描述         |
| -------------------------- | ------ | -------- | ---------------- |
| count                      | -      | integer  | 总记录数         |
| next                       | -      | string   | 下一页链接       |
| previous                   | -      | string   | 上一页链接       |
| results.id                 | -      | integer  | 记录ID           |
| results.ip_address         | -      | string   | IP地址           |
| results.username           | -      | string   | 用户名           |
| results.login_time         | -      | string   | 登录时间         |
| results.risk_score         | -      | number   | 风险评分         |
| results.risk_level         | -      | string   | 风险等级         |
| results.risk_level_display | -      | string   | 风险等级显示名称 |
| results.is_malicious       | -      | boolean  | 是否为恶意登录   |
| results.status             | -      | string   | 处理状态         |
| results.status_display     | -      | string   | 状态显示名称     |
| results.user_agent         | -      | string   | 用户代理         |
| results.location           | -      | string   | 登录位置         |
| results.anomaly_type       | -      | string   | 异常类型         |
| results.notes              | -      | string   | 备注             |
| results.created_at         | -      | string   | 创建时间         |
| results.updated_at         | -      | string   | 更新时间         |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 创建检测记录

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:40:57

**创建新的检测记录**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
    "ip_address": "192.168.0.1",
    "username": "string",
    "login_time": "2019-08-24T14:15:22.123Z",
    "user_agent": "string",
    "location": "string",
    "risk_score": 0.0,
    "risk_level": "low",
    "is_malicious": false
}
```

| 参数名     | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ---------- | ------ | -------- | -------- | -------- |
| ip_address | -      | string   | 是       | IP地址   |
| username   | -      | string   | 是       | 用户名   |
| login_time | -      | string   | 是       | 登录时间 |
| user_agent | -      | string   | 否       | 用户代理 |
| location   | -      | string   | 否       | 登录位置 |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"id":17,"risk_level_display":"低风险","status_display":"待处理","ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"low","is_malicious":false,"detection_features":{},"user_agent":"string","location":"string","status":"pending","notes":"","created_at":"2025-09-05T15:40:53.005234","updated_at":"2025-09-05T15:40:53.005234"}
```

- 失败(404)

```javascript
暂无数据;
```

- 检测记录创建成功(201)

```javascript
{
	"id": 0,
	"ip_address": "",
	"username": "",
	"login_time": "",
	"risk_score": "",
	"risk_level": "",
	"risk_level_display": "",
	"is_malicious": "",
	"status": "",
	"status_display": "",
	"user_agent": "",
	"location": "",
	"anomaly_type": "",
	"notes": "",
	"created_at": "",
	"updated_at": ""
}
```

| 参数名             | 示例值 | 参数类型 | 参数描述         |
| ------------------ | ------ | -------- | ---------------- |
| id                 | -      | integer  | 记录ID           |
| ip_address         | -      | string   | IP地址           |
| username           | -      | string   | 用户名           |
| login_time         | -      | string   | 登录时间         |
| risk_score         | -      | number   | 风险评分         |
| risk_level         | -      | string   | 风险等级         |
| risk_level_display | -      | string   | 风险等级显示名称 |
| is_malicious       | -      | boolean  | 是否为恶意登录   |
| status             | -      | string   | 处理状态         |
| status_display     | -      | string   | 状态显示名称     |
| user_agent         | -      | string   | 用户代理         |
| location           | -      | string   | 登录位置         |
| anomaly_type       | -      | string   | 异常类型         |
| notes              | -      | string   | 备注             |
| created_at         | -      | string   | 创建时间         |
| updated_at         | -      | string   | 更新时间         |

**Query**

### 获取单个检测记录

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:41:05

**获取指定ID的检测记录详细信息**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/3/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取检测记录(200)

```javascript
{"id":3,"risk_level_display":"低风险","status_display":"待处理","ip_address":"192.168.1.300","username":"testuser3","login_time":"2025-09-05T14:21:15.368463","risk_score":0.0,"risk_level":"low","is_malicious":false,"detection_features":{"method":"rule_based","confidence":0.6},"user_agent":"Mozilla/5.0","location":"Guangzhou","status":"pending","notes":"","created_at":"2025-09-05T14:21:15.368463","updated_at":"2025-09-05T14:21:15.368463"}
```

| 参数名             | 示例值 | 参数类型 | 参数描述         |
| ------------------ | ------ | -------- | ---------------- |
| id                 | -      | integer  | 记录ID           |
| ip_address         | -      | string   | IP地址           |
| username           | -      | string   | 用户名           |
| login_time         | -      | string   | 登录时间         |
| risk_score         | -      | number   | 风险评分         |
| risk_level         | -      | string   | 风险等级         |
| risk_level_display | -      | string   | 风险等级显示名称 |
| is_malicious       | -      | boolean  | 是否为恶意登录   |
| status             | -      | string   | 处理状态         |
| status_display     | -      | string   | 状态显示名称     |
| user_agent         | -      | string   | 用户代理         |
| location           | -      | string   | 登录位置         |
| anomaly_type       | -      | string   | 异常类型         |
| notes              | -      | string   | 备注             |
| created_at         | -      | string   | 创建时间         |
| updated_at         | -      | string   | 更新时间         |

- 检测记录不存在(404)

```javascript
{
	"success": "",
	"error": "",
	"error_code": "",
	"details": {}
}
```

| 参数名     | 示例值 | 参数类型 | 参数描述 |
| ---------- | ------ | -------- | -------- |
| success    | -      | boolean  | -        |
| error      | -      | string   | 错误描述 |
| error_code | -      | string   | 错误代码 |
| details    | -      | object   | 错误详情 |

**Query**

### 更新检测记录

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:50:39

**更新指定ID的检测记录**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/3/

**请求方式**

> PUT

**Content-Type**

> json

**请求Body参数**

```javascript
{

			"ip_address": "192.168.0.1",
			"username": "string",
			"login_time": "2019-08-24T14:15:22.123000",
			"risk_score": 0,
			"risk_level": "low",
			"risk_level_display": "低风险",
			"is_malicious": false,
			"location": "string",
			"status": "pending",
			"status_display": "待处理",
			"created_at": "2025-09-05T15:13:17.734706"
		}
```

| 参数名 | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ------ | ------ | -------- | -------- | -------- |
| status | -      | string   | 否       | 处理状态 |
| notes  | -      | string   | 否       | 备注     |

**认证方式**

> 继承父级

**响应示例**

- 检测记录更新成功(200)

```javascript
{"id":3,"risk_level_display":"低风险","status_display":"待处理","ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"low","is_malicious":false,"detection_features":{"method":"rule_based","confidence":0.6},"user_agent":"Mozilla/5.0","location":"string","status":"pending","notes":"string","created_at":"2025-09-05T14:21:15.368463","updated_at":"2025-09-05T15:50:35.605981"}
```

| 参数名             | 示例值 | 参数类型 | 参数描述         |
| ------------------ | ------ | -------- | ---------------- |
| id                 | -      | integer  | 记录ID           |
| ip_address         | -      | string   | IP地址           |
| username           | -      | string   | 用户名           |
| login_time         | -      | string   | 登录时间         |
| risk_score         | -      | number   | 风险评分         |
| risk_level         | -      | string   | 风险等级         |
| risk_level_display | -      | string   | 风险等级显示名称 |
| is_malicious       | -      | boolean  | 是否为恶意登录   |
| status             | -      | string   | 处理状态         |
| status_display     | -      | string   | 状态显示名称     |
| user_agent         | -      | string   | 用户代理         |
| location           | -      | string   | 登录位置         |
| anomaly_type       | -      | string   | 异常类型         |
| notes              | -      | string   | 备注             |
| created_at         | -      | string   | 创建时间         |
| updated_at         | -      | string   | 更新时间         |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 删除检测记录

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:51:10

**删除指定ID的检测记录**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/2/

**请求方式**

> DELETE

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"code":500,"msg":"删除检测记录失败: No DetectionRecord matches the given query.","data":null}
```

- 失败(404)

```javascript
暂无数据;
```

- 检测记录删除成功(204)

```javascript
暂无数据;
```

**Query**

### 更新检测记录状态

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:52:43

**更新检测记录的处理状态**

**接口状态**

> 开发中

**接口URL**

> /malicious/detectionRecords/3/update_status/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"status": "ignored",
	"notes": "string"
}
```

| 参数名 | 示例值 | 参数类型 | 是否必填 | 参数描述                      |
| ------ | ------ | -------- | -------- | ----------------------------- |
| status | -      | string   | 是       | 新状态 ('pending', '待处理'), |

        ('processing', '处理中'),
        ('resolved', '已解决'),
        ('ignored', '已忽略'), |

| notes | - | string | 否 | 处理备注 |

**认证方式**

> 继承父级

**响应示例**

- 状态更新成功(200)

```javascript
{"id":3,"risk_level_display":"低风险","status_display":"已忽略","ip_address":"192.168.0.1","username":"string","login_time":"2019-08-24T14:15:22.123000","risk_score":0.0,"risk_level":"low","is_malicious":false,"detection_features":{"method":"rule_based","confidence":0.6},"user_agent":"Mozilla/5.0","location":"string","status":"ignored","notes":"string","created_at":"2025-09-05T14:21:15.368463","updated_at":"2025-09-05T15:52:03.932858"}
```

| 参数名             | 示例值 | 参数类型 | 参数描述         |
| ------------------ | ------ | -------- | ---------------- |
| id                 | -      | integer  | 记录ID           |
| ip_address         | -      | string   | IP地址           |
| username           | -      | string   | 用户名           |
| login_time         | -      | string   | 登录时间         |
| risk_score         | -      | number   | 风险评分         |
| risk_level         | -      | string   | 风险等级         |
| risk_level_display | -      | string   | 风险等级显示名称 |
| is_malicious       | -      | boolean  | 是否为恶意登录   |
| status             | -      | string   | 处理状态         |
| status_display     | -      | string   | 状态显示名称     |
| user_agent         | -      | string   | 用户代理         |
| location           | -      | string   | 登录位置         |
| anomaly_type       | -      | string   | 异常类型         |
| notes              | -      | string   | 备注             |
| created_at         | -      | string   | 创建时间         |
| updated_at         | -      | string   | 更新时间         |

- 失败(404)

```javascript
暂无数据;
```

**Query**

## 检测配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取检测配置列表

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:52:44

**获取所有检测配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/detection-configs/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取检测配置列表(200)

```javascript
{"code":200,"msg":"获取检测配置列表成功","data":[{"id":2,"name":"string","detection_interval":0,"sensitivity":"low","threshold_high":0.8,"threshold_medium":0.5,"is_active":true,"created_at":"2025-09-05T15:51:10.909028","updated_at":"2025-09-05T15:51:10.909028"}]}
```

| 参数名                | 示例值 | 参数类型 | 参数描述       |
| --------------------- | ------ | -------- | -------------- |
| id                    | -      | integer  | 配置ID         |
| name                  | -      | string   | 配置名称       |
| description           | -      | string   | 配置描述       |
| sensitivity           | -      | number   | 敏感度         |
| high_risk_threshold   | -      | number   | 高风险阈值     |
| medium_risk_threshold | -      | number   | 中风险阈值     |
| detection_interval    | -      | integer  | 检测间隔（秒） |
| is_active             | -      | boolean  | 是否激活       |
| created_at            | -      | string   | 创建时间       |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 创建检测配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:54:19

**创建新的检测配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/detection-configs/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"name": "test1",
	"description": "string",
	"sensitivity": "low",
	"high_risk_threshold": 0,
	"medium_risk_threshold": 0,
	"detection_interval": 0
}
```

| 参数名                | 示例值 | 参数类型 | 是否必填 | 参数描述            |
| --------------------- | ------ | -------- | -------- | ------------------- |
| name                  | -      | string   | 是       | 配置名称            |
| description           | -      | string   | 否       | 配置描述            |
| sensitivity           | -      | number   | 是       | 敏感度 minimal、low |
| high_risk_threshold   | -      | number   | 是       | 高风险阈值          |
| medium_risk_threshold | -      | number   | 是       | 中风险阈值          |
| detection_interval    | -      | integer  | 否       | 检测间隔（秒）      |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"id":4,"name":"test1","detection_interval":0,"sensitivity":"low","threshold_high":0.8,"threshold_medium":0.5,"is_active":true,"created_at":"2025-09-05T15:54:16.150140","updated_at":"2025-09-05T15:54:16.150140"}
```

- 失败(404)

```javascript
暂无数据;
```

- 检测配置创建成功(201)

```javascript
{
	"id": 0,
	"name": "",
	"description": "",
	"sensitivity": "",
	"high_risk_threshold": "",
	"medium_risk_threshold": "",
	"detection_interval": 0,
	"is_active": "",
	"created_at": ""
}
```

| 参数名                | 示例值 | 参数类型 | 参数描述       |
| --------------------- | ------ | -------- | -------------- |
| id                    | -      | integer  | 配置ID         |
| name                  | -      | string   | 配置名称       |
| description           | -      | string   | 配置描述       |
| sensitivity           | -      | number   | 敏感度         |
| high_risk_threshold   | -      | number   | 高风险阈值     |
| medium_risk_threshold | -      | number   | 中风险阈值     |
| detection_interval    | -      | integer  | 检测间隔（秒） |
| is_active             | -      | boolean  | 是否激活       |
| created_at            | -      | string   | 创建时间       |

**Query**

### 禁用检测配置

POST /malicious/detection-configs/{id}/deactivate/

### 激活检测配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:54:34

**激活指定的检测配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/detection-configs/2/activate/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 配置激活成功(200)

```javascript
{"code":200,"msg":"成功激活检测配置: string","data":{"id":2,"name":"string","detection_interval":0,"sensitivity":"low","threshold_high":0.8,"threshold_medium":0.5,"is_active":true,"created_at":"2025-09-05T15:51:10.909028","updated_at":"2025-09-05T15:54:30.633015"}}
```

| 参数名                | 示例值 | 参数类型 | 参数描述       |
| --------------------- | ------ | -------- | -------------- |
| id                    | -      | integer  | 配置ID         |
| name                  | -      | string   | 配置名称       |
| description           | -      | string   | 配置描述       |
| sensitivity           | -      | number   | 敏感度         |
| high_risk_threshold   | -      | number   | 高风险阈值     |
| medium_risk_threshold | -      | number   | 中风险阈值     |
| detection_interval    | -      | integer  | 检测间隔（秒） |
| is_active             | -      | boolean  | 是否激活       |
| created_at            | -      | string   | 创建时间       |

- 失败(404)

```javascript
暂无数据;
```

**Query**

## 通知配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取通知配置列表

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:55:12

**获取所有通知配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/notification-configs/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取通知配置列表(200)

```javascript
{"code":200,"msg":"获取通知配置列表成功","data":[]}
```

| 参数名             | 示例值 | 参数类型 | 参数描述 |
| ------------------ | ------ | -------- | -------- |
| id                 | -      | integer  | 配置ID   |
| name               | -      | string   | 配置名称 |
| notification_type  | -      | string   | 通知类型 |
| config_data        | -      | object   | 配置数据 |
| trigger_conditions | -      | object   | 触发条件 |
| is_enabled         | -      | boolean  | 是否启用 |
| created_at         | -      | string   | 创建时间 |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 创建通知配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:55:47

**创建新的通知配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/notification-configs/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"name": "test1",
	"notification_type": "email",
	"config_data": {},
	"trigger_conditions": {}
}
```

| 参数名             | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ------------------ | ------ | -------- | -------- | -------- |
| name               | -      | string   | 是       | 配置名称 |
| notification_type  | -      | string   | 是       | 通知类型 |
| config_data        | -      | object   | 是       | 配置数据 |
| trigger_conditions | -      | object   | 否       | 触发条件 |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"id":3,"notification_type_display":"邮件","name":"test1","notification_type":"email","recipients":[],"smtp_config":{},"webhook_url":"","trigger_conditions":{},"is_active":true,"created_at":"2025-09-05T15:55:43.638593","updated_at":"2025-09-05T15:55:43.638593"}
```

- 失败(404)

```javascript
暂无数据;
```

- 通知配置创建成功(201)

```javascript
{
	"id": 0,
	"name": "",
	"notification_type": "",
	"config_data": {},
	"trigger_conditions": {},
	"is_enabled": "",
	"created_at": ""
}
```

| 参数名             | 示例值 | 参数类型 | 参数描述 |
| ------------------ | ------ | -------- | -------- |
| id                 | -      | integer  | 配置ID   |
| name               | -      | string   | 配置名称 |
| notification_type  | -      | string   | 通知类型 |
| config_data        | -      | object   | 配置数据 |
| trigger_conditions | -      | object   | 触发条件 |
| is_enabled         | -      | boolean  | 是否启用 |
| created_at         | -      | string   | 创建时间 |

**Query**

### 测试通知配置

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:56:21

**测试指定的通知配置**

**接口状态**

> 开发中

**接口URL**

> /malicious/notification-configs/3/test_notification/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 测试通知发送成功(200)

```javascript
{"code":500,"msg":"发送测试通知失败: NOT NULL constraint failed: malicious_notification_record.detection_record_id","data":null}
```

| 参数名  | 示例值 | 参数类型 | 参数描述 |
| ------- | ------ | -------- | -------- |
| success | -      | boolean  | -        |
| message | -      | string   | -        |

- 失败(404)

```javascript
暂无数据;
```

**Query**

## IP黑名单

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取黑名单IP列表

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:57:31

**获取所有黑名单IP**

**接口状态**

> 开发中

**接口URL**

> /malicious/blacklist-ips/?page=1&page_size=10

**请求方式**

> GET

**Content-Type**

> json

**请求Query参数**

| 参数名    | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| --------- | ------ | -------- | -------- | -------- |
| page      | 1      | integer  | 否       | 页码     |
| page_size | 10     | integer  | 否       | 每页数量 |

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取黑名单IP列表(200)

```javascript
{"code":200,"msg":"获取IP黑名单列表成功","data":[{"id":2,"is_expired_flag":false,"ip_address":"192.168.12.3","reason":"我不喜欢","is_active":true,"expires_at":null,"created_at":"2025-09-05T15:57:24.095781","updated_at":"2025-09-05T15:57:24.095781","added_by":null}]}
```

| 参数名             | 示例值 | 参数类型 | 参数描述   |
| ------------------ | ------ | -------- | ---------- |
| count              | -      | integer  | 总记录数   |
| next               | -      | string   | 下一页链接 |
| previous           | -      | string   | 上一页链接 |
| results.id         | -      | integer  | 记录ID     |
| results.ip_address | -      | string   | IP地址     |
| results.reason     | -      | string   | 添加原因   |
| results.severity   | -      | string   | 严重程度   |
| results.added_by   | -      | string   | 添加者     |
| results.is_active  | -      | boolean  | 是否激活   |
| results.created_at | -      | string   | 创建时间   |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 添加IP到黑名单

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:57:27

**添加新的IP到黑名单**

**接口状态**

> 开发中

**接口URL**

> /malicious/blacklist-ips/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"ip_address": "192.168.12.3",
	"reason": "我不喜欢",
	"severity": "medium"
}
```

| 参数名     | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ---------- | ------ | -------- | -------- | -------- |
| ip_address | -      | string   | 是       | IP地址   |
| reason     | -      | string   | 是       | 添加原因 |
| severity   | medium | string   | 否       | 严重程度 |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"id":2,"is_expired_flag":false,"ip_address":"192.168.12.3","reason":"我不喜欢","is_active":true,"expires_at":null,"created_at":"2025-09-05T15:57:24.095781","updated_at":"2025-09-05T15:57:24.095781","added_by":null}
```

- 失败(404)

```javascript
暂无数据;
```

- IP添加到黑名单成功(201)

```javascript
{
	"id": 0,
	"ip_address": "",
	"reason": "",
	"severity": "",
	"added_by": "",
	"is_active": "",
	"created_at": ""
}
```

| 参数名     | 示例值 | 参数类型 | 参数描述 |
| ---------- | ------ | -------- | -------- |
| id         | -      | integer  | 记录ID   |
| ip_address | -      | string   | IP地址   |
| reason     | -      | string   | 添加原因 |
| severity   | -      | string   | 严重程度 |
| added_by   | -      | string   | 添加者   |
| is_active  | -      | boolean  | 是否激活 |
| created_at | -      | string   | 创建时间 |

**Query**

### 批量添加IP到黑名单

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:57:55

**批量添加多个IP到黑名单**

**接口状态**

> 开发中

**接口URL**

> /malicious/blacklist-ips/batch_add/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"ip_list": [
		"123123",["123"]
	],
	"reason": "1",
	"severity": "medium"
}
```

| 参数名    | 示例值 | 参数类型 | 是否必填 | 参数描述   |
| --------- | ------ | -------- | -------- | ---------- |
| ip_list.0 | -      | array    | 是       | IP地址列表 |
| reason    | -      | string   | 否       | 添加原因   |
| severity  | medium | string   | 否       | 严重程度   |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"code":500,"msg":"批量添加IP失败: Cannot assign \"<django.contrib.auth.models.AnonymousUser object at 0x000001FC0036E3C0>\": \"BlacklistIP.added_by\" must be a \"User\" instance.","data":null}
```

- 失败(404)

```javascript
暂无数据;
```

- 批量添加成功(201)

```javascript
{
	"success": "",
	"added_count": 0,
	"message": ""
}
```

| 参数名      | 示例值 | 参数类型 | 参数描述 |
| ----------- | ------ | -------- | -------- |
| success     | -      | boolean  | -        |
| added_count | -      | integer  | -        |
| message     | -      | string   | -        |

**Query**

## 系统统计

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:33:28

```text
暂无描述
```

**目录Header参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Query参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录Body参数**

| 参数名   | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| -------- | ------ | -------- | -------- | -------- |
| 暂无参数 |

**目录认证信息**

> 继承父级

**Query**

### 获取系统统计数据

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:58:06

**获取系统统计数据**

**接口状态**

> 开发中

**接口URL**

> /malicious/system-stats/

**请求方式**

> GET

**Content-Type**

> json

**请求Body参数**

```javascript
暂无数据;
```

**认证方式**

> 继承父级

**响应示例**

- 成功获取系统统计数据(200)

```javascript
{"code":200,"msg":"获取系统统计列表成功","data":[{"id":1,"date":"2025-09-05","total_detections":10,"malicious_count":0,"high_risk_count":0,"medium_risk_count":0,"low_risk_count":3,"unique_ips":7,"threat_ips":0,"notifications_sent":0,"created_at":"2025-09-05T14:50:40.332423","updated_at":"2025-09-05T14:50:40.332423"}]}
```

| 参数名               | 示例值 | 参数类型 | 参数描述     |
| -------------------- | ------ | -------- | ------------ |
| id                   | -      | integer  | 统计ID       |
| date                 | -      | string   | 统计日期     |
| total_detections     | -      | integer  | 总检测次数   |
| malicious_detections | -      | integer  | 恶意检测次数 |
| false_positives      | -      | integer  | 误报次数     |
| unique_ips           | -      | integer  | 唯一IP数     |
| unique_users         | -      | integer  | 唯一用户数   |
| avg_risk_score       | -      | number   | 平均风险评分 |
| created_at           | -      | string   | 创建时间     |

- 失败(404)

```javascript
暂无数据;
```

**Query**

### 生成每日统计

> 创建人: 0120suileyan

> 更新人: 0120suileyan

> 创建时间: 2025-09-05 15:33:28

> 更新时间: 2025-09-05 15:58:39

**生成指定日期的每日统计数据**

**接口状态**

> 开发中

**接口URL**

> /malicious/system-stats/generate_daily_stats/

**请求方式**

> POST

**Content-Type**

> json

**请求Body参数**

```javascript
{
	"date": "2025-09-05"
}
```

| 参数名 | 示例值 | 参数类型 | 是否必填 | 参数描述 |
| ------ | ------ | -------- | -------- | -------- |
| date   | -      | string   | 是       | 统计日期 |

**认证方式**

> 继承父级

**响应示例**

- 成功(200)

```javascript
{"code":200,"msg":"生成每日统计数据成功","data":{"created":false,"stats":{"id":1,"date":"2025-09-05","total_detections":19,"malicious_count":0,"high_risk_count":0,"medium_risk_count":0,"low_risk_count":9,"unique_ips":6,"threat_ips":0,"notifications_sent":0,"created_at":"2025-09-05T14:50:40.332423","updated_at":"2025-09-05T15:58:33.095665"}}}
```

- 失败(404)

```javascript
暂无数据;
```

- 每日统计生成成功(201)

```javascript
{
	"id": 0,
	"date": "",
	"total_detections": 0,
	"malicious_detections": 0,
	"false_positives": 0,
	"unique_ips": 0,
	"unique_users": 0,
	"avg_risk_score": "",
	"created_at": ""
}
```

| 参数名               | 示例值 | 参数类型 | 参数描述     |
| -------------------- | ------ | -------- | ------------ |
| id                   | -      | integer  | 统计ID       |
| date                 | -      | string   | 统计日期     |
| total_detections     | -      | integer  | 总检测次数   |
| malicious_detections | -      | integer  | 恶意检测次数 |
| false_positives      | -      | integer  | 误报次数     |
| unique_ips           | -      | integer  | 唯一IP数     |
| unique_users         | -      | integer  | 唯一用户数   |
| avg_risk_score       | -      | number   | 平均风险评分 |
| created_at           | -      | string   | 创建时间     |

**Query**
